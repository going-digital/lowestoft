# From https://www.iho.int/mtg_docs/com_wg/IHOTC/IHOTC_Misc/TWCWG_Constituent_list.pdf

coeff_deg_per_hr = [
    0.000000, 0.041067, 0.0410686, 0.0821373, 0.1232039, 0.4715211, 0.5443747,
    1.0158958, 1.0980330, 1.4874168, 1.5602705, 1.5695541, 1.6424078,
    2.0317915, 2.1139287, 2.1867829, 2.5761662,
    
    12.854286, 12.8542862, 12.9271398, 13.3986609, 13.4715145, 13.4715146,
    13.9430356, 13.9841042, 14.0251729, 14.025173, 14.487410, 14.4874103,
    14.492052, 14.4966939, 14.496694, 14.5695476, 14.9178647, 14.9589314,
    15.0000000, 15.000002, 15.0410686, 15.041069, 15.0821353, 15.1232059,
    15.123206, 15.5125897, 15.5854433, 15.5854434, 15.9748271, 16.0569644,
    16.1391017, 16.6834764,
    
    26.4079380, 26.8701754, 26.8794591, 26.9523127, 26.952313, 26.9615964,
    27.341696, 27.3416965, 27.4238338, 27.4966874, 27.505971, 27.8039339,
    27.8860712, 27.8953548, 27.9682085, 28.3575923, 28.3986629, 28.398663,
    28.4397295, 28.4807962, 28.480798, 28.5125832, 28.6040041, 28.9019670,
    28.9112506, 28.943036, 28.9430356, 28.9430376, 28.9841042, 29.0251788,
    29.0251729, 29.025173, 29.0662415, 29.066242, 29.1483780, 29.1483788,
    29.3734880, 29.4556253, 29.5284789, 29.5284790, 29.537763, 29.5377626,
    29.9178627, 29.9589333, 30.0000000, 30.0410667, 30.0821373, 30.4715211,
    30.5443747, 30.5536583, 30.6265120, 30.7086493, 31.0158958, 31.0887494,
    31.0980330, 31.4874168, 31.5602705, 31.6424078, 32.0317915, 32.1139288,

    42.382765, 42.3827651, 42.9271398, 42.927140, 42.9364235, 42.9682085,
    43.0092771, 43.4761564, 43.4807982, 43.480798, 43.9430356, 43.943036,
    43.9841042, 44.0251729, 44.025173, 44.4966939, 44.5695476, 44.958931,
    44.9589314, 45.000000, 45.0410686, 45.041069, 45.1232059, 45.123206,
    46.0569644,
    
    55.9364170, 56.3258007, 56.3350844, 56.4079380, 56.4807917, 56.8701754,
    56.879459, 56.8794591, 56.9523127, 56.9615964, 57.341695, 57.4238338,
    57.4966874, 57.5059711, 57.8860712, 57.927140, 57.9682085, 58.0092752,
    58.0503458, 58.4397295, 58.512583, 58.5125832, 58.5218668, 58.521867,
    58.9019670, 58.901967, 58.9430376, 58.9841042, 59.0251709, 59.0662415,
    59.4556253, 59.5284790, 59.5284794, 59.6106162, 59.9589333,
    60.0000000, 60.0821373, 60.1642746, 61.0158958, 61.0980330,
    
    71.366869, 71.3668694, 71.453648, 71.911244, 71.9112441, 71.9205277,
    71.9523127, 71.9933814, 72.3827651, 72.460261, 72.464902, 72.4649024,
    72.501329, 72.9271398, 72.927140, 72.9682085, 73.009277, 73.471515,
    73.5536518, 73.9430356, 74.0251729, 74.025173, 74.1073102, 74.9589314,
    75.0410686, 75.1232059,
    
    84.7655303, 84.8383839, 84.8476676, 84.9205212, 85.3099050, 85.3191886,
    85.3920423, 85.4013259, 85.4648959, 85.8542797, 85.863563, 85.8635633,
    85.9364170, 85.9457006, 86.3258007, 86.4079380, 86.4807917, 86.480792,
    86.4900753, 86.8701754, 86.911244, 86.9523127, 87.0344500, 87.3827671,
    87.4238338, 87.496687, 87.4966874, 87.505971, 87.5059711, 87.5788247,
    87.8860712, 87.9271418, 87.9682085, 88.0503458, 88.4397295, 88.4715165,
    88.512583, 88.5125832, 88.5218668, 88.521867, 88.594720, 88.5947205,
    88.9430376, 88.9841042, 89.0662415, 89.066242, 89.1483788, 89.4874123,
    89.5284790, 89.6106162, 90.0000000,
    
    100.3509736, 100.8953438, 100.9046320, 101.3668694, 101.4443667,
    101.449006, 101.4490067, 101.9112441, 101.9933814, 103.0092771,

    113.8317718, 114.3761465, 114.8383839, 114.8476676, 114.9205212,
    114.9298048, 115.3099050, 115.3920423, 115.4648959, 115.4741795,
    115.8542797, 115.895348, 115.9364170, 116.0185542, 116.4079380,
    116.4807917, 116.4900753, 116.8701754, 116.8794591, 116.9112460,
    116.9523127, 117.0344500, 117.4238338, 117.423834, 117.4966874,
    117.5059711, 117.578825, 117.9271418, 117.9682085, 118.0503458,
    118.1324830, 118.4397295, 118.5125832, 118.5218668, 118.5947205,
    118.9841042, 119.0662415, 120.0000000, 129.3350779, 129.8887362,
    129.888738, 130.387400, 130.4331109, 130.9774856, 131.9933814,
    
    143.3602507, 143.8317718, 143.9046254, 143.9139091, 144.2940092,
    144.3761465, 144.4490002, 144.8383839, 144.9205212, 145.0026585,
    145.3920423, 145.4648959, 145.4741795, 145.8635633, 145.9364170,
    146.0185542, 146.4079380, 146.4900753, 146.5629217, 146.9523127,
    147.0344500, 147.4238338, 147.5059711, 147.578825, 147.9682085,
    148.0503458,
    
    160.9774856,
    
    171.7999803, 172.2715013, 172.3443550, 172.8158760, 172.8887297,
    172.8980133, 173.2781135, 173.3602507, 173.362457, 173.4331044,
    173.8224882, 173.831772, 173.863557, 173.9046254, 174.3761465,
    174.449000, 174.4582838, 174.8476676, 174.8794545, 174.9205212,
    175.0026585, 175.3920423, 175.4648959, 175.4741795, 175.547033,
    175.8953503, 175.9364170, 176.0185542, 176.9523127, 177.0344500,
    
    203.3602507, 203.4423880, 203.9046254
]

coeff_rad_per_day = coeff_deg_per_hr * 24 * math.pi / 180

# First remove DC offset.
# Loop through coefficients. Look for highest correlation.
#Â Calculate residual.
# Repeat until residual is negligible, or coefficient limit
# Perform test. Evaluate predictive model.
